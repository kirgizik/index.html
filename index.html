<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ñ–∏—Ä–Ω–∞—è –õ–æ–≤–ª—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            font-family: 'Arial', sans-serif;
            height: 100vh;
            overflow: hidden;
            touch-action: none;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: background 0.3s ease;
        }
        
        #startScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .menu-buttons {
            position: absolute;
            top: 20px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
        }
        
        .help-btn, .achievements-btn, .pi-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 1.2em;
            color: white;
            cursor: pointer;
            backdrop-filter: blur(10px);
        }
        
        .pi-btn {
            font-size: 0.9em;
            padding: 5px;
        }
        
        .title {
            font-size: 3em;
            color: white;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.5em;
            color: #ffeb3b;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .total-coins {
            font-size: 1.8em;
            color: #ffeb3b;
            margin-bottom: 10px;
            text-align: center;
            background: rgba(0,0,0,0.3);
            padding: 10px 20px;
            border-radius: 20px;
        }
        
        .user-id {
            position: absolute;
            bottom: 10px;
            left: 10px;
            font-size: 0.9em;
            color: rgba(255,255,255,0.7);
            background: rgba(0,0,0,0.3);
            padding: 5px 10px;
            border-radius: 10px;
        }
        
        .start-btn {
            background: linear-gradient(45deg, #ff4081, #f50057);
            border: none;
            padding: 20px 50px;
            font-size: 1.8em;
            color: white;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }
        
        .start-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }
        
        .menu-buttons-row {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        .menu-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            border: none;
            padding: 12px 20px;
            font-size: 1.1em;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            min-width: 120px;
            transition: all 0.3s ease;
        }
        
        .menu-btn:hover {
            transform: scale(1.05);
        }

        .daily-bonus-btn {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            border: none;
            padding: 15px 25px;
            font-size: 1.3em;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            margin: 6px;
            min-width: 200px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255,215,0,0.4);
        }
        
        .daily-bonus-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(255,215,0,0.6);
        }
        
        .daily-bonus-btn:disabled {
            background: linear-gradient(45deg, #7f8c8d, #95a5a6);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        #gameScreen {
            display: none;
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .game-ui {
            position: absolute;
            top: 20px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 100;
        }
        
        .ui-left, .ui-right {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .lives, .coins, .timer, .booster-timer {
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1.5em;
            backdrop-filter: blur(10px);
            text-align: center;
            min-width: 120px;
        }
        
        .booster-timer {
            display: none;
        }
        
        .game-area {
            width: 100%;
            height: 100%;
            position: relative;
            background: linear-gradient(180deg, #87CEEB, #98FB98);
            overflow: hidden;
        }
        
        .pig {
            position: absolute;
            font-size: 4em;
            transition: transform 0.2s ease;
            z-index: 10;
            user-select: none;
            filter: drop-shadow(3px 3px 5px rgba(0,0,0,0.3));
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .food {
            position: absolute;
            font-size: 2.5em;
            z-index: 5;
            user-select: none;
            transition: transform 0.1s ease;
        }
        
        .healthy-food {
            font-size: 3em;
            animation: float 4s ease-in-out infinite;
        }
        
        .fast-food {
            animation: float 3s ease-in-out infinite;
        }
        
        .booster-item {
            font-size: 2.8em;
            animation: spin 2s linear infinite;
            filter: drop-shadow(0 0 8px #ffeb3b);
        }
        
        .honey {
            font-size: 3.5em;
            animation: honeyGlow 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px gold);
        }
        
        .mushroom {
            font-size: 3.2em;
            animation: mushroomGlow 3s ease-in-out infinite;
            filter: drop-shadow(0 0 12px #8B4513);
        }
        
        .magnet {
            font-size: 2.8em;
            animation: magnetGlow 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px #2196F3);
        }
        
        .barrier {
            font-size: 2.8em;
            animation: barrierGlow 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px #00FF00);
        }
        
        .coin-text {
            position: absolute;
            font-size: 1.5em;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 20;
            pointer-events: none;
            animation: coinFloat 1s ease-out forwards;
        }
        
        @keyframes coinFloat {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes honeyGlow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        @keyframes mushroomGlow {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(5deg); }
            75% { transform: scale(1.1) rotate(-5deg); }
        }
        
        @keyframes magnetGlow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes barrierGlow {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        #resultScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
        }
        
        .result-content {
            background: rgba(255,255,255,0.1);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            max-width: 500px;
            width: 90%;
        }
        
        .result-title {
            font-size: 3em;
            margin-bottom: 20px;
            color: #ffeb3b;
        }
        
        .result-stats {
            font-size: 1.5em;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        #achievementsScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
            padding: 20px;
        }
        
        .achievements-container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .achievement {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            padding: 20px;
            margin: 15px 0;
            border-radius: 15px;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .achievement.unlocked {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
        }
        
        .achievement-count {
            position: absolute;
            top: 10px;
            right: 15px;
            background: rgba(0,0,0,0.3);
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .achievement-icon {
            font-size: 3em;
            margin-right: 20px;
        }
        
        .achievement-info {
            flex: 1;
            text-align: left;
        }
        
        .achievement-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 5px;
            color: white;
        }
        
        .achievement-desc {
            font-size: 1em;
            color: rgba(255,255,255,0.8);
        }
        
        #helpScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
            padding: 20px;
        }
        
        #wallpaperScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
            padding: 20px;
        }
        
        .wallpaper-content {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .color-palette {
            display: grid;
            grid-template-columns: repeat(5, 50px);
            grid-template-rows: repeat(4, 50px);
            gap: 10px;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            justify-content: center;
        }
        
        .color-item {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }
        
        .color-item:hover {
            transform: scale(1.1);
            border-color: white;
        }
        
        .color-item.selected {
            border-color: #ffeb3b;
            transform: scale(1.1);
        }
        
        .upload-btn {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 2em;
            color: white;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }
        
        .upload-btn:hover {
            transform: scale(1.1);
        }
        
        .confirm-btn {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
        }
        
        .confirm-btn:hover {
            transform: scale(1.05);
        }
        
        #shopScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
            padding: 20px;
        }
        
        .shop-container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .shop-item {
            background: linear-gradient(45deg, #3498db, #2980b9);
            padding: 20px;
            margin: 10px 0;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .shop-item:hover {
            transform: scale(1.02);
        }
        
        .shop-item-count {
            position: absolute;
            top: 10px;
            right: 15px;
            background: rgba(0,0,0,0.3);
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .shop-item-info {
            flex: 1;
            text-align: left;
        }
        
        .shop-item-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 5px;
            color: white;
        }
        
        .shop-item-desc {
            font-size: 0.9em;
            color: rgba(255,255,255,0.8);
            margin-bottom: 5px;
        }
        
        .shop-item-price {
            font-size: 1.1em;
            color: #ffeb3b;
            font-weight: bold;
        }
        
        .buy-btn {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .buy-btn:hover {
            transform: scale(1.1);
        }
        
        .buy-btn:disabled {
            background: linear-gradient(45deg, #7f8c8d, #95a5a6);
            cursor: not-allowed;
            transform: none;
        }
        
        #powerupsScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
            padding: 20px;
        }
        
        .powerup-item {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            padding: 20px;
            margin: 10px 0;
            border-radius: 15px;
            width: 300px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .powerup-item:hover {
            transform: scale(1.05);
        }
        
        .powerup-item.selected {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            transform: scale(1.05);
        }
        
        .powerup-count {
            position: absolute;
            top: 10px;
            right: 15px;
            background: rgba(0,0,0,0.3);
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        #pauseScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
        }
        
        .pause-content {
            background: rgba(255,255,255,0.1);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            max-width: 400px;
            width: 90%;
        }
        
        .pause-title {
            font-size: 3em;
            margin-bottom: 30px;
            color: #ffeb3b;
        }
        
        .pause-btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            border: none;
            padding: 15px 30px;
            font-size: 1.3em;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            width: 200px;
            transition: all 0.3s ease;
        }
        
        .pause-btn:hover {
            transform: scale(1.05);
        }
        
        .game-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            z-index: 3000;
            display: none;
            animation: notificationPop 0.5s ease-out;
        }
        
        @keyframes notificationPop {
            0% { transform: translate(-50%, -50%) scale(0); }
            70% { transform: translate(-50%, -50%) scale(1.1); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        #friendsScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
            padding: 20px;
        }
        
        .friends-container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .profile-edit {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            padding: 20px;
            margin: 15px 0;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .profile-edit:hover {
            transform: scale(1.02);
        }
        
        .profile-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .profile-avatar {
            font-size: 2.5em;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
        }
        
        .profile-name {
            font-size: 1.3em;
            font-weight: bold;
        }
        
        .search-friend {
            background: linear-gradient(45deg, #3498db, #2980b9);
            padding: 20px;
            margin: 15px 0;
            border-radius: 15px;
            text-align: center;
        }
        
        .search-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            text-align: center;
        }
        
        #profileEditScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
            padding: 20px;
        }
        
        .profile-edit-container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .avatar-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
        }
        
        .avatar-item {
            font-size: 2em;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            background: rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }
        
        .avatar-item:hover {
            transform: scale(1.1);
            background: rgba(255,255,255,0.2);
        }
        
        .avatar-item.selected {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ —á–∏—Å–ª–∞ –ü–∏ */
        .pi-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            display: none;
            overflow: hidden;
        }

        .pi-text {
            position: absolute;
            color: #00ff00;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            white-space: nowrap;
            opacity: 0.8;
            text-shadow: 0 0 10px #00ff00;
            animation: piGlitch 0.1s infinite;
        }

        @keyframes piGlitch {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(2px, -2px) rotate(1deg); }
            50% { transform: translate(-2px, 2px) rotate(-1deg); }
            75% { transform: translate(1px, -1px) rotate(0.5deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }

        .vibration-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: 9998;
            display: none;
            animation: vibrate 0.1s infinite;
        }

        @keyframes vibrate {
            0% { transform: translate(0, 0); }
            20% { transform: translate(-2px, -2px); }
            40% { transform: translate(2px, 2px); }
            60% { transform: translate(-1px, 1px); }
            80% { transform: translate(1px, -1px); }
            100% { transform: translate(0, 0); }
        }

        .flashlight-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0) 70%);
            z-index: 9997;
            display: none;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div id="startScreen">
        <div class="menu-buttons">
            <button class="help-btn" onclick="showHelp()">‚ùì</button>
            <!-- –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ö–ù–û–ü–ö–ê "–ê —ç—Ç —á–µ?" -->
            <button class="pi-btn" onclick="togglePi()">–ê —ç—Ç —á–µ?</button>
            <button class="achievements-btn" onclick="showAchievements()">üèÜ</button>
        </div>
        <div class="title">üê∑ –ñ–ò–†–ù–ê–Ø –õ–û–í–õ–Ø üçî</div>
        <div class="subtitle">–õ–æ–≤–∏ —Ñ–∞—Å—Ç—Ñ—É–¥, –∏–∑–±–µ–≥–∞–π –∑–¥–æ—Ä–æ–≤–æ–π –ø–∏—â–∏! üéØ</div>
        <div class="total-coins" id="totalCoinsDisplay">–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: 0 ü™ô</div>
        <button class="start-btn" onclick="showPowerups()">üéÆ –ù–ê–ß–ê–¢–¨ –ò–ì–†–£</button>
        <button class="daily-bonus-btn" id="dailyBonusBtn" onclick="claimDailyBonus()">üéÅ –ï–ñ–ï–î–ù–ï–í–ù–´–ô –ë–û–ù–£–°</button>
        <div class="menu-buttons-row">
            <button class="menu-btn" onclick="showWallpaper()">üé® –û–±–æ–∏</button>
            <button class="menu-btn" onclick="showShop()">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
            <button class="menu-btn" onclick="showFriends()">üë• –î—Ä—É–∑—å—è</button>
        </div>
        <div class="user-id" id="userIdDisplay">ID: –∑–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <!-- –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ê —ç—Ç —á–µ?" -->
    <div class="vibration-effect" id="vibrationEffect"></div>
    <div class="flashlight-effect" id="flashlightEffect"></div>
    <div class="pi-overlay" id="piOverlay"></div>

    <div id="gameScreen">
        <div class="game-ui">
            <div class="ui-left">
                <div class="lives">‚ù§Ô∏è: <span id="livesCount">1</span></div>
                <div class="coins">ü™ô: <span id="coinsCount">0</span></div>
            </div>
            <div class="ui-right">
                <div class="timer">‚è±Ô∏è: <span id="timer">40</span></div>
                <div class="booster-timer" id="boosterTimer1"></div>
                <div class="booster-timer" id="boosterTimer2"></div>
                <div class="booster-timer" id="boosterTimer3"></div>
                <div class="booster-timer" id="boosterTimer4"></div>
            </div>
        </div>
        
        <div class="game-area" id="gameArea">
            <div class="pig" id="pig">üê∑</div>
        </div>
    </div>

    <div id="resultScreen">
        <div class="result-content">
            <div class="result-title">üéÆ –ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê</div>
            <div class="result-stats">
                <div>ü™ô –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: <span id="finalCoins">0</span> –∂—ã—Ä–∫–æ–∏–Ω–æ–≤</div>
                <div>‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–∂–∏–≤–∞–Ω–∏—è: <span id="finalTime">0</span>—Å</div>
                <div id="achievementsEarned"></div>
            </div>
            <button class="start-btn" onclick="exitToMenu()">üè† –í –ú–ï–ù–Æ</button>
        </div>
    </div>

    <div id="achievementsScreen">
        <div class="achievements-container">
            <div class="result-title">üèÜ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø</div>
            <div class="achievement" id="achievement1">
                <div class="achievement-icon">üïã</div>
                <div class="achievement-info">
                    <div class="achievement-name">–ù–ê–°–¢–û–Ø–©–ò–ô –ú–£–°–£–õ–¨–ú–ê–ù–ò–ù</div>
                    <div class="achievement-desc">–ü—Ä–æ–∂–∏—Ç—å –≤—Å–µ 40 —Å–µ–∫—É–Ω–¥ –∏ –Ω–µ —Å—ä–µ—Å—Ç—å –Ω–∏ –æ–¥–Ω–æ–≥–æ –±–µ–∫–æ–Ω–∞</div>
                </div>
                <div class="achievement-count" id="achievement1Count">0</div>
            </div>
            <div class="achievement" id="achievement2">
                <div class="achievement-icon">üë±</div>
                <div class="achievement-info">
                    <div class="achievement-name">–¢–ï–ü–ï–†–¨ –¢–´ –ù–û–†–ú–ê–õ–¨–ù–´–ô –ß–ï–õ–û–í–ï–ö</div>
                    <div class="achievement-desc">–í—ã–∂–∏—Ç—å –ø–æ—Å–ª–µ –≥—Ä–∏–±–∞, –ø–∏—Ç–∞—è—Å—å —Ç–æ–ª—å–∫–æ –æ–≤–æ—â–∞–º–∏</div>
                </div>
                <div class="achievement-count" id="achievement2Count">0</div>
            </div>
            <div class="achievement" id="achievement3">
                <div class="achievement-icon">?</div>
                <div class="achievement-info">
                    <div class="achievement-name">‚®Ö·îë·ìµ‚çë ‚Ñ∏·í∑ ñ·í∑ ·í∑‚Ñ∏ùôπ?</div>
                    <div class="achievement-desc">Íñå‚öç!¬°‚ïé‚Ñ∏‚çä Íñå·îëÍñå‚öç!¬° ‚Ñ∏ùôπ ‚çë‚à∑·í∑„É™‚ïé 10 ‚à∑·îë‚®Ö</div>
                </div>
            </div>
            <button class="start-btn" onclick="hideAchievements()" style="margin-top: 20px;">üëå –ó–ê–ö–†–´–¢–¨</button>
        </div>
    </div>

    <div id="helpScreen">
        <div class="result-content">
            <div class="result-title">‚ùì –ü–†–ê–í–ò–õ–ê –ò–ì–†–´</div>
            <div style="text-align: left; font-size: 1.2em; line-height: 1.6;">
                <p>üê∑ –£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–∏–Ω–∫–æ–π –ø–∞–ª—å—Ü–µ–º</p>
                <p>üçî –§–∞—Å—Ç—Ñ—É–¥: +10 –º–æ–Ω–µ—Ç</p>
                <p>ü•¨ –û–≤–æ—â–∏: -1 –∑–¥–æ—Ä–æ–≤—å–µ</p>
                <p>üçÑ –ì—Ä–∏–±: –¥–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ (–æ–≤–æ—â–∏ +10, —Ñ–∞—Å—Ç—Ñ—É–¥ -1 –∂–∏–∑–Ω—å)</p>
                <p>üõ°Ô∏è –ë–∞—Ä—å–µ—Ä: —É–±–∏—Ä–∞–µ—Ç –≤—Å–µ –æ–≤–æ—â–∏ –Ω–∞ 15 —Å–µ–∫—É–Ω–¥</p>
                <p>üçØ –ú–µ–¥: —Ç–æ–ª—å–∫–æ —Å–ª–∞–¥–æ—Å—Ç–∏ x2 —Ü–µ–Ω—ã</p>
                <p>ü™ô –ú–æ–Ω–µ—Ç–∞: x2 –º–æ–Ω–µ—Ç—ã 10 —Å–µ–∫</p>
                <p>‚ö° –ú–æ–ª–Ω–∏—è: –º–Ω–æ–≥–æ –æ–≤–æ—â–µ–π, —Ñ–∞—Å—Ç—Ñ—É–¥ x4</p>
                <p>üß≤ –ú–∞–≥–Ω–∏—Ç: –ø—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç —Ñ–∞—Å—Ç—Ñ—É–¥</p>
            </div>
            <button class="start-btn" onclick="hideHelp()">üëå –ó–ê–ö–†–´–¢–¨</button>
        </div>
    </div>

    <div id="wallpaperScreen">
        <div class="wallpaper-content">
            <div class="result-title">üé® –í–´–ë–û–† –û–ë–û–ï–í</div>
            <div class="color-palette" id="colorPalette"></div>
            <div>
                <button class="upload-btn" onclick="document.getElementById('wallpaperUpload').click()">+</button>
                <input type="file" id="wallpaperUpload" accept="image/*" style="display: none;" onchange="handleWallpaperUpload(event)">
            </div>
            <button class="confirm-btn" onclick="applySelectedWallpaper()">‚úÖ –ü–û–î–¢–í–ï–†–î–ò–¢–¨</button>
            <button class="start-btn" onclick="hideWallpaper()" style="margin-top: 20px;">üëå –ó–ê–ö–†–´–¢–¨</button>
        </div>
    </div>

    <div id="shopScreen">
        <div class="shop-container">
            <div class="result-title">üõí –ú–ê–ì–ê–ó–ò–ù</div>
            <div class="shop-item">
                <div class="shop-item-info">
                    <div class="shop-item-name">–í—Ç–æ—Ä–∞—è –∂–∏–∑–Ω—å</div>
                    <div class="shop-item-desc">–î–∞—ë—Ç —Å–≤–∏–Ω–∫–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∂–∏–∑–Ω—å –Ω–∞ –æ–¥–Ω—É –∏–≥—Ä—É</div>
                    <div class="shop-item-price">400 ü™ô</div>
                </div>
                <div class="shop-item-count" id="shopExtraLifeCount">0</div>
                <button class="buy-btn" onclick="buyPowerup('extraLife')" id="buyExtraLife">–ö–£–ü–ò–¢–¨</button>
            </div>
            <div class="shop-item">
                <div class="shop-item-info">
                    <div class="shop-item-name">–ó–∞–º–µ–¥–ª–µ–Ω–∏–µ</div>
                    <div class="shop-item-desc">–ü–µ—Ä–≤—ã–µ 20 —Å–µ–∫—É–Ω–¥ –æ–≤–æ—â–∏ –ª–µ—Ç—è—Ç –Ω–∞ 20% –º–µ–¥–ª–µ–Ω–Ω–µ–µ</div>
                    <div class="shop-item-price">200 ü™ô</div>
                </div>
                <div class="shop-item-count" id="shopSlowMotionCount">0</div>
                <button class="buy-btn" onclick="buyPowerup('slowMotion')" id="buySlowMotion">–ö–£–ü–ò–¢–¨</button>
            </div>
            <div class="shop-item">
                <div class="shop-item-info">
                    <div class="shop-item-name">–•–∑ —á–µ —ç—Ç–æ</div>
                    <div class="shop-item-price">500 ü™ô</div>
                </div>
                <div class="shop-item-count" id="shopMysteryCount">0</div>
                <button class="buy-btn" onclick="buyPowerup('mystery')" id="buyMystery">–ö–£–ü–ò–¢–¨</button>
            </div>
            <button class="start-btn" onclick="hideShop()" style="margin-top: 20px;">üëå –ó–ê–ö–†–´–¢–¨</button>
        </div>
    </div>

    <div id="friendsScreen">
        <div class="friends-container">
            <div class="result-title">üë• –î–†–£–ó–¨–Ø</div>
            <div class="profile-edit" onclick="showProfileEdit()">
                <div class="profile-info">
                    <div class="profile-avatar" id="currentAvatar">üê∑</div>
                    <div class="profile-name" id="currentName">–ò–≥—Ä–æ–∫ 1</div>
                </div>
                <div>‚úèÔ∏è</div>
            </div>
            <div class="search-friend">
                <div>üîç –ù–ê–ô–¢–ò –î–†–£–ì–ê –ü–û ID</div>
                <input type="number" class="search-input" id="friendSearch" placeholder="–í–≤–µ–¥–∏—Ç–µ ID –¥—Ä—É–≥–∞">
                <button class="confirm-btn" onclick="searchFriend()" style="margin-top: 10px;">–ù–ê–ô–¢–ò</button>
            </div>
            <button class="start-btn" onclick="hideFriends()" style="margin-top: 20px;">üëå –ó–ê–ö–†–´–¢–¨</button>
        </div>
    </div>

    <div id="profileEditScreen">
        <div class="profile-edit-container">
            <div class="result-title">‚úèÔ∏è –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –ü–†–û–§–ò–õ–Ø</div>
            <input type="text" class="search-input" id="profileNameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" value="–ò–≥—Ä–æ–∫ 1">
            <div class="avatar-grid" id="avatarGrid"></div>
            <button class="confirm-btn" onclick="saveProfile()">‚úÖ –°–û–•–†–ê–ù–ò–¢–¨</button>
            <button class="start-btn" onclick="hideProfileEdit()" style="margin-top: 10px;">üëå –ó–ê–ö–†–´–¢–¨</button>
        </div>
    </div>

    <div id="powerupsScreen">
        <div class="result-content">
            <div class="result-title">‚ö° –í–´–ë–û–† –£–°–ò–õ–ï–ù–ò–ô</div>
            <div class="powerup-item" onclick="selectPowerup('extraLife')" id="powerupExtraLife">
                <div class="shop-item-name">–í—Ç–æ—Ä–∞—è –∂–∏–∑–Ω—å</div>
                <div class="shop-item-desc">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∂–∏–∑–Ω—å</div>
                <div class="powerup-count" id="powerupExtraLifeCount">0</div>
            </div>
            <div class="powerup-item" onclick="selectPowerup('slowMotion')" id="powerupSlowMotion">
                <div class="shop-item-name">–ó–∞–º–µ–¥–ª–µ–Ω–∏–µ</div>
                <div class="shop-item-desc">–û–≤–æ—â–∏ –º–µ–¥–ª–µ–Ω–Ω–µ–µ 20 —Å–µ–∫</div>
                <div class="powerup-count" id="powerupSlowMotionCount">0</div>
            </div>
            <div class="powerup-item" onclick="selectPowerup('mystery')" id="powerupMystery">
                <div class="shop-item-name">–•–∑ —á–µ —ç—Ç–æ</div>
                <div class="shop-item-desc">–ó–∞–≥–∞–¥–æ—á–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç</div>
                <div class="powerup-count" id="powerupMysteryCount">0</div>
            </div>
            <button class="start-btn" onclick="startGameWithPowerups()" style="margin-top: 20px;">üéÆ –ù–ê–ß–ê–¢–¨ –ò–ì–†–£</button>
        </div>
    </div>

    <div id="pauseScreen">
        <div class="pause-content">
            <div class="pause-title">‚è∏Ô∏è –ü–ê–£–ó–ê</div>
            <button class="pause-btn" onclick="resumeGame()">‚ñ∂Ô∏è –ü–†–û–î–û–õ–ñ–ò–¢–¨</button>
            <button class="pause-btn" onclick="showAchievementsFromPause()">üèÜ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø</button>
            <button class="pause-btn" onclick="exitToMenuFromPause()">üè† –í–´–ô–¢–ò</button>
        </div>
    </div>

    <div class="game-notification" id="gameNotification"></div>

    <script>
        const config = {
            gameTime: 40,
            spawnInterval: 400,
            fastFoodEmojis: ['ü•™', 'üå≠', 'üçü', 'üçî', 'üçï', 'üçñ', 'ü•ì', 'üçó', 'üåØ'],
            healthyFoodEmojis: ['ü•¶', 'ü•¨', 'üåΩ', 'ü•ï', 'üçÜ', 'ü•ë', 'üçÖ', 'üçé', 'üçå', 'üçí', 'ü´ë', 'ü•í'],
            boosterEmojis: {
                coin: 'ü™ô',
                noHealthy: 'üõ°Ô∏è',
                lightning: '‚ö°',
                magnet: 'üß≤'
            },
            honeyEmoji: 'üçØ',
            mushroomEmoji: 'üçÑ',
            avatarEmojis: ['üê≠', 'üê∑', 'ü´Ñ', 'ü•∏', 'üëπ', 'üí©', 'ü¶µ', 'üí™', 'ü´Å', 'üëÉ', 'üëÖ', 'üëÅÔ∏è', 'üë∂', 'üßå']
        };

        let gameActive = false;
        let lives = 1;
        let coins = 0;
        let timeLeft = config.gameTime;
        let pigElement;
        let gameArea;
        let allFood = [];
        let activeBoosters = {};
        let spawnInterval;
        let gameTimer;
        let isDragging = false;
        let selectedPowerup = null;
        let gamePaused = false;
        let selectedColor = null;
        let selectedImage = null;
        let mushroomEaten = false;
        let mushroomActivated = false;
        let foodSpeedMultiplier = 1;
        let mushroomSpawned = false;
        let foodSpawned = 0;
        let lightningActive = false;
        let magnetActive = false;
        let barrierActive = false;
        let difficultyLevel = 1;
        let baseFoodSpeed = 2;
        let humanTransformationTimer = null;
        let nextUserId = 1;
        
        // –ù–û–í–ê–Ø –ü–ï–†–ï–ú–ï–ù–ù–ê–Ø: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º, –±—ã–ª –ª–∏ —Å—ä–µ–¥–µ–Ω –≥—Ä–∏–± –≤ —Ç–µ–∫—É—â–µ–π –∏–≥—Ä–µ
        let mushroomEatenThisGame = false;
        
        let userData = {
            totalCoins: 0,
            achievements: {
                muslim: { unlocked: false, count: 0 },
                normalHuman: { unlocked: false, count: 0 },
                mysteryBuyer: { unlocked: false, count: 0 }
            },
            powerups: {
                extraLife: 0,
                slowMotion: 0,
                mystery: 0
            },
            background: null,
            lastDailyBonus: null,
            profile: {
                name: "–ò–≥—Ä–æ–∫ 1",
                avatar: "üê∑",
                id: 1
            },
            friends: []
        };

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ê —ç—Ç —á–µ?"
        let piActive = false;
        let vibrationInterval = null;

        function togglePi() {
            const vibrationEffect = document.getElementById('vibrationEffect');
            const flashlightEffect = document.getElementById('flashlightEffect');
            const piOverlay = document.getElementById('piOverlay');
            
            if (!piActive) {
                // –í–ö–õ–Æ–ß–ê–ï–ú
                piActive = true;
                
                // –í–∫–ª—é—á–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç —Ñ–æ–Ω–∞—Ä–∏–∫–∞
                if (flashlightEffect) flashlightEffect.style.display = 'block';
                
                // –í–∫–ª—é—á–∞–µ–º –≤–∏–±—Ä–∞—Ü–∏—é
                startVibration(vibrationEffect);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á–∏—Å–ª–æ –ü–∏
                showPiOverlay(piOverlay);
                
                // –ö–æ–ø–∏—Ä—É–µ–º —á–∏—Å–ª–æ –ü–∏
                copyPi();
                
            } else {
                // –í–´–ö–õ–Æ–ß–ê–ï–ú
                piActive = false;
                
                // –í—ã–∫–ª—é—á–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç —Ñ–æ–Ω–∞—Ä–∏–∫–∞
                if (flashlightEffect) flashlightEffect.style.display = 'none';
                
                // –í—ã–∫–ª—é—á–∞–µ–º –≤–∏–±—Ä–∞—Ü–∏—é
                stopVibration(vibrationEffect);
                
                // –°–∫—Ä—ã–≤–∞–µ–º —á–∏—Å–ª–æ –ü–∏
                hidePiOverlay(piOverlay);
            }
        }

        function showPiOverlay(overlay) {
            if (!overlay) return;
            
            overlay.style.display = 'block';
            overlay.innerHTML = '';
            
            const piNumber = "3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679";
            
            for (let i = 0; i < 30; i++) {
                const piText = document.createElement('div');
                piText.className = 'pi-text';
                piText.textContent = piNumber;
                piText.style.left = Math.random() * 100 + 'vw';
                piText.style.top = Math.random() * 100 + 'vh';
                piText.style.fontSize = (Math.random() * 6 + 10) + 'px';
                piText.style.opacity = Math.random() * 0.6 + 0.4;
                overlay.appendChild(piText);
            }
        }

        function hidePiOverlay(overlay) {
            if (overlay) {
                overlay.style.display = 'none';
                overlay.innerHTML = '';
            }
        }

        function startVibration(vibrationEffect) {
            if (vibrationEffect) vibrationEffect.style.display = 'block';
            
            if (navigator.vibrate) {
                try {
                    navigator.vibrate(10000);
                    vibrationInterval = setInterval(() => {
                        navigator.vibrate([200, 100, 200, 100, 200]);
                    }, 1000);
                } catch (e) {
                    console.log('–í–∏–±—Ä–∞—Ü–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞');
                }
            }
        }

        function stopVibration(vibrationEffect) {
            if (vibrationEffect) vibrationEffect.style.display = 'none';
            
            if (navigator.vibrate) {
                navigator.vibrate(0);
            }
            if (vibrationInterval) {
                clearInterval(vibrationInterval);
                vibrationInterval = null;
            }
        }

        function copyPi() {
            const piNumber = "3,141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587006606315588174881520920962829254091715364367892590360011330530548820466521384146951941511609433057270365759591953092186117381932611793105118548074462379962749567351885752724891227938183011949129833673362440656643086021394946395224737190702179860943702770539217176293176752384674818467669405132000568127145263560827785771342757789609173637178721468440901224953430146549585371050792279689258923542019956112129021960864034418159813629774771309960518707211349999998372978049951059731732816096318595024459455346908302642522308253344685035261931188171010003137838752886587533208381420617177669147303598253490428755468731159562863882353787593751957781857780532171226806613001927876611195909216420198938095257201065485863278865936153381827968230301952035301852968995773622599413891249721775283479131515574857242454150695950829533116861727855889075098381754637464939319255060400927701671139009848824012858361603563707660104710181942955596198946767837449448255379774726847104047534646208046684259069491293313677028989152104752162056966024058038150193511253382430035587640247496473263914199272604269922796782354781636009341721641219924586315030286182974555706749838505494588586926995690927210797509302955321165344987202755960236480665499119881834797753566369807426542527862551818417574672890977772793800081647060016145249192173217214772350141441973568548161361157352552133475741849468438523323907394143334547762416862518983569485562099219222184272550254256887671790494601653466804988627232791786085784383827967976681454100953883786360950680064225125205117392984896084128488626945604241965285022210661186306744278622039194945047123713786960956364371917287467764657573962413890865832645995813390478027590099465764078951269468398352595709825822620522489407726719478268482601476990902640136394437455305068203496252451749399651431429809190659250937221696461515709858387410597885959772975498—ã930161753928468138268683868942774155991855925245953959431049972524680845987273644695848653836736222626099124608051243884390451244136549762780797715691435997700129616089441694868555848406353422072225828488648158456028506016842739452267467678895252138522549954666727823986456596116354886230577456498035593634568174324112515076069479451096596094025228879710893145669136867228748940560101503308617928680920874760917824938589009714909675985261365549781893129784821682998948722658804857564014270477555132379641451523746234364542858444795265867821051141354735739523113427166102135969536231442952484937187110145765403590279934403742007310578539062198387447808478489683321445713868751943506430218453191048481005370614680674919278191197939952061419663428754440643745123718192179998391015919561814675142691239748940907186494231961567945208095146550225231603881930142093762137855956638937787083039069792077346722182562599661501421503068038447734549202605414665925201497442850732518666002132434088190710486331734649651453905796268561005081066587969981635747363840525714591028970641401109712062804390397595156771577004203378699360072305587631763594218731251471205329281918261861258673215791984148488291644706095752706957220917567116722910981690915280173506712748583222871835209353965725121083579151369882091444210067510334671103141267111369908658516398315019701651511685171437657618351556508849099898599823873455283316355076479185358932261854896321329330898570642046752590709154814165498594616371802709819943099244889575712828905923233260972997120844335732654893823911932597463667305836041428138830320382490375898524374417029132765618093773444030707469211201913020330380197621101100449293215160842444859637669838952286847831235526582131449576857262433441893039686426243410773226978028073189154411010446823252716201052652272111660396665573092547110557853763466820653109896526918620564769312570586356620185581007293606598764861179104533488503461136576867532494416680396265797877185560845529654126654085306143444318586769751456614068007002378776591344017127494704205622305389945613140711270004078547332699390814546646458807972708266830634328587856983052358089330657574067954571637752542021149557615814002501262285941302164715509792592309907965473761255176567513575178296664547791745011299614890304639947132962107340437518957359614589019389713111790429782856475032031986915140287080859904801094121472213179476477726224142548545403321571853061422881375850430633217518297986622371721591607716692547487389866549494501146540628433663937900397692656721463853067360965712091807638327166416274888800786925602902284721040317211860820419000422966171196377921337575114959501566049631862947265473642523081770367515906735023507283540567040386743513622224771589150495309844489333096340878076932599397805419341447377441842631298608099888687413260472156951623965864573021631598193195167353812974167729478672422924654366800980676928238280689964004824354037014163149658979409243237896907069779422362508221688957383798623001593776471651228935786015881617557829735233446042815126272037343146531977774160319906655418763979293344195215413418994854447345673831624993419131814809277771038638773431772075456545322077709212019051660962804909263601975988281613323166636528619326686336062735676303544776280350450777235547105859548702790814356240145171806246436267945612753181340783303362542327839449753824372058353114771199260638133467768796959703098339130771098704085913374641442822772634659470474587847787201927715280731767907707157213444730605700733492436931138350493163128404251219256517980694113528013147013047816437885185290928545201165839341965621349143415956258658655705526904965209858033850722426482939728584783163057777560688876446248246857926039535277348030480290058760758251047470916439613626760449256274204208320856611906254543372131535958450687724602901618766795240616342522577195429162991930645537799140373404328752628889639958794757291746426357455254079091451357111369410911939325191076020825202618798531887705842972591677813149699009019211697173727847684726860849003377024242916513005005168323364350389517029893922334517220138128069650117844087451960121228599371623130171144484640903890644954440061986907548516026327505298349187407866808818338510228334508504860825039302133219715518430635455007668282949304137765527939751754613953984683393638304746119966538581538420568533862186725233402830871123282789212507712629463229563989898935821167456270102183564622013496715188190973038119800497340723961036854066431939509790190699639552453005450580685501956730229219139339185680344903982059551002263535361920419947455385938102343955449597783779023742161727111723643435439478221818528624085140066604433258885698670543154706965747458550332323342107301545940516553790686627333799585115625784322988273723198987571415957811196358330059408730681216028764962867446047746491599505497374256269010490377819868359381465741268049256487985561453723478673303904688383436346553794986419270563872931748723320837601123029911367938627089438799362016295154133714248928307220126901475466847653576164773794675200490757155527819653621323926406160136358155907422020203187277605272190055614842555187925303435139844253223415762336106425063904975008656271095359194658975141310348227693062474353632569160781547818115284366795706110861533150445212747392454494542368288606134084148637767009612071512491404302725386076482363414334623518975766452164137679690314950191085759844239198629164219399490723623464684411739403265918404437805133389452574239950829659122850855582157250310712570126683024029295252201187267675622041542051618416348475651699981161410100299607838690929160302884002691041407928862150784245167090870006992821206604183718065355672525325675328612910424877618258297651579598470356222629348600341587229805349896502262917487882027342092222453398562647669149055628425039127577102840279980663658254889264880254566101729670266407655904290994568150652653053718294127033693137851786090407086671149655834343476933857817113864558736781230145876871266034891390956200993936103102916161528813843790990423174733639480457593149314052976347574811935670911013775172100803155902485309066920376719220332290943346768514221447737939375170344366199104033751117354719185504644902636551281622882446257591633303910722538374218214088350865739177150968288747826569959957449066175834413752239709683408005355984917541738188399944697486762655165827658483588453142775687900290951702835297163445621296404352311760066510124120065975585127617858382920419748442360800719304576189323492292796501987518721272675079812554709589045563579212210333466974992356302549478024901141952123828153091140790738602515227429958180724716259166854513331239480494707911915326734302824418604142636395480004480026704962482017928964766975831832713142517029692348896276684403232609275249603579964692565049368183609003238092934595889706953653494060340216654437558900456328822505452556405644824651518754711962184439658253375438856909411303150952617937800297412076651479394259029896959469955657612186561967337862362561252163208628692221032748892186543648022967807057656151446320469279068212073883778142335628236089632080682224680122482611771858963814091839036736722208883215137556003727983940041529700287830766709444745601345564172543709069793961225714298946715435784687886144458123145935719849225284716050492212424701412147805734551050080190869960330276347870810817545011930714122339086639383395294257869050764310063835198343893415961318543";
    
            const textArea = document.createElement('textarea');
            textArea.value = piNumber;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
            } catch (e) {
                console.log('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è');
            }
            
            document.body.removeChild(textArea);
        }

        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
        window.addEventListener('beforeunload', function() {
            if (piActive) {
                stopVibration(document.getElementById('vibrationEffect'));
                const flashlightEffect = document.getElementById('flashlightEffect');
                if (flashlightEffect) flashlightEffect.style.display = 'none';
            }
        });

        function getUserId() {
            let storedId = localStorage.getItem('fatCatchUserId');
            if (!storedId) {
                storedId = nextUserId.toString();
                localStorage.setItem('fatCatchUserId', storedId);
                nextUserId++;
            }
            return storedId;
        }

        function loadUserData() {
            const userId = getUserId();
            document.getElementById('userIdDisplay').textContent = `ID: ${userId}`;
            
            const saved = localStorage.getItem(`fatCatchData_${userId}`);
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    Object.assign(userData, parsed);
                    applyBackground();
                    updateDailyBonusButton();
                    updateProfileDisplay();
                } catch (e) {
                    console.log('–ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã');
                }
            }
            updateAllDisplays();
        }

        function saveUserData() {
            const userId = getUserId();
            localStorage.setItem(`fatCatchData_${userId}`, JSON.stringify(userData));
            updateAllDisplays();
        }

        function updateAllDisplays() {
            document.getElementById('totalCoinsDisplay').textContent = `–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: ${userData.totalCoins} ü™ô`;
            
            const a1 = document.getElementById('achievement1');
            const a2 = document.getElementById('achievement2');
            const a3 = document.getElementById('achievement3');
            
            if (userData.achievements.muslim.unlocked) {
                a1.className = 'achievement unlocked';
                document.getElementById('achievement1Count').textContent = userData.achievements.muslim.count;
            } else {
                a1.className = 'achievement';
                document.getElementById('achievement1Count').textContent = '0';
            }
            
            if (userData.achievements.normalHuman.unlocked) {
                a2.className = 'achievement unlocked';
                document.getElementById('achievement2Count').textContent = userData.achievements.normalHuman.count;
            } else {
                a2.className = 'achievement';
                document.getElementById('achievement2Count').textContent = '0';
            }
            
            if (userData.achievements.mysteryBuyer.unlocked) {
                a3.className = 'achievement unlocked';
                a3.querySelector('.achievement-icon').textContent = 'üßê';
                a3.querySelector('.achievement-name').textContent = '–ó–∞—á —Ç–µ–±–µ —ç—Ç–æ?';
                a3.querySelector('.achievement-desc').textContent = '–ö—É–ø–∏—Ç—å –∫–∞–∫—É—é —Ç–æ —Ö—Ä–µ–Ω—å 10 —Ä–∞–∑';
            } else {
                a3.className = 'achievement';
                a3.querySelector('.achievement-icon').textContent = '?';
                a3.querySelector('.achievement-name').textContent = '‚®Ö·îë·ìµ‚çë ‚Ñ∏·í∑ ñ·í∑ ·í∑‚Ñ∏ùôπ?';
                a3.querySelector('.achievement-desc').textContent = 'Íñå‚öç!¬°‚ïé‚Ñ∏‚çä Íñå·îëÍñå‚öç!¬° ‚Ñ∏ùôπ ‚çë‚à∑·í∑„É™‚ïé 10 ‚à∑·îë‚®Ö';
            }
            
            document.getElementById('shopExtraLifeCount').textContent = userData.powerups.extraLife;
            document.getElementById('shopSlowMotionCount').textContent = userData.powerups.slowMotion;
            document.getElementById('shopMysteryCount').textContent = userData.powerups.mystery;
            
            document.getElementById('buyExtraLife').disabled = userData.totalCoins < 400;
            document.getElementById('buySlowMotion').disabled = userData.totalCoins < 200;
            document.getElementById('buyMystery').disabled = userData.totalCoins < 500;
            
            document.getElementById('powerupExtraLifeCount').textContent = userData.powerups.extraLife;
            document.getElementById('powerupSlowMotionCount').textContent = userData.powerups.slowMotion;
            document.getElementById('powerupMysteryCount').textContent = userData.powerups.mystery;
        }

        function updateProfileDisplay() {
            document.getElementById('currentAvatar').textContent = userData.profile.avatar;
            document.getElementById('currentName').textContent = userData.profile.name;
            document.getElementById('profileNameInput').value = userData.profile.name;
        }

        function generateColorPalette() {
            const palette = document.getElementById('colorPalette');
            palette.innerHTML = '';
            
            const colors = [
                '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7',
                '#DDA0DD', '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E9',
                '#F8C471', '#82E0AA', '#F1948A', '#85C1E9', '#D7BDE2',
                '#A9DFBF', '#F9E79F', '#D5DBDB', '#FAD7A0', '#AED6F1'
            ];
            
            colors.forEach(color => {
                const item = document.createElement('div');
                item.className = 'color-item';
                item.style.backgroundColor = color;
                item.onclick = () => {
                    document.querySelectorAll('.color-item').forEach(i => i.classList.remove('selected'));
                    item.classList.add('selected');
                    selectedColor = color;
                    selectedImage = null;
                };
                palette.appendChild(item);
            });
        }

        function generateAvatarGrid() {
            const grid = document.getElementById('avatarGrid');
            grid.innerHTML = '';
            
            config.avatarEmojis.forEach(emoji => {
                const item = document.createElement('div');
                item.className = 'avatar-item';
                if (emoji === userData.profile.avatar) {
                    item.classList.add('selected');
                }
                item.textContent = emoji;
                item.onclick = () => {
                    document.querySelectorAll('.avatar-item').forEach(i => i.classList.remove('selected'));
                    item.classList.add('selected');
                    userData.profile.avatar = emoji;
                };
                grid.appendChild(item);
            });
        }

        function applySelectedWallpaper() {
            if (selectedColor) {
                userData.background = { type: 'color', value: selectedColor };
                saveUserData();
                applyBackground();
                showNotification('üé® –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω!');
                hideWallpaper();
            } else if (selectedImage) {
                userData.background = { type: 'image', value: selectedImage };
                saveUserData();
                applyBackground();
                showNotification('üñºÔ∏è –û–±–æ–∏ —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!');
                hideWallpaper();
            } else {
                showNotification('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ!');
            }
        }

        function handleWallpaperUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    selectedImage = e.target.result;
                    selectedColor = null;
                    document.querySelectorAll('.color-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    showNotification('üì∏ –§–æ—Ç–æ –≤—ã–±—Ä–∞–Ω–æ! –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"');
                };
                reader.readAsDataURL(file);
            }
        }

        function applyBackground() {
            if (userData.background) {
                if (userData.background.type === 'color') {
                    document.body.style.background = userData.background.value;
                    document.body.style.backgroundImage = 'none';
                } else if (userData.background.type === 'image') {
                    document.body.style.backgroundImage = `url('${userData.background.value}')`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    document.body.style.backgroundRepeat = 'no-repeat';
                }
            } else {
                document.body.style.background = 'linear-gradient(135deg, #ff6b6b, #ffa726)';
                document.body.style.backgroundImage = 'none';
            }
        }

        function showNotification(text) {
            const notification = document.getElementById('gameNotification');
            notification.textContent = text;
            notification.style.display = 'block';
            setTimeout(() => notification.style.display = 'none', 2000);
        }

        function showCoinText(value, x, y) {
            const coinText = document.createElement('div');
            coinText.className = 'coin-text';
            coinText.textContent = `+${value}ü™ô`;
            coinText.style.left = x + 'px';
            coinText.style.top = y + 'px';
            gameArea.appendChild(coinText);
            
            setTimeout(() => {
                if (coinText.parentNode) {
                    coinText.remove();
                }
            }, 1000);
        }

        function canClaimDailyBonus() {
            if (!userData.lastDailyBonus) return true;
            const lastClaim = new Date(userData.lastDailyBonus);
            const now = new Date();
            return now.toDateString() !== lastClaim.toDateString();
        }

        function updateDailyBonusButton() {
            const btn = document.getElementById('dailyBonusBtn');
            if (canClaimDailyBonus()) {
                btn.disabled = false;
                btn.textContent = 'üéÅ –ï–ñ–ï–î–ù–ï–í–ù–´–ô –ë–û–ù–£–°';
            } else {
                btn.disabled = true;
                btn.textContent = 'üéÅ –ë–û–ù–£–° –ü–û–õ–£–ß–ï–ù';
            }
        }

        function claimDailyBonus() {
            if (!canClaimDailyBonus()) {
                showNotification('‚ùå –ë–æ–Ω—É—Å —É–∂–µ –ø–æ–ª—É—á–µ–Ω —Å–µ–≥–æ–¥–Ω—è!');
                return;
            }

            userData.totalCoins += 200;
            userData.lastDailyBonus = new Date().toISOString();
            saveUserData();
            updateDailyBonusButton();
            showNotification('üéÅ +200 –∂—ã—Ä–∫–æ–∏–Ω–æ–≤! –í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∑–∞–≤—Ç—Ä–∞!');
        }

        function buyPowerup(type) {
            const prices = { extraLife: 400, slowMotion: 200, mystery: 500 };
            
            if (userData.totalCoins >= prices[type]) {
                userData.totalCoins -= prices[type];
                userData.powerups[type]++;
                
                if (type === 'mystery' && userData.powerups.mystery >= 10) {
                    userData.achievements.mysteryBuyer.unlocked = true;
                    userData.achievements.mysteryBuyer.count = 1;
                    showNotification('üéâ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: "–ó–∞—á —Ç–µ–±–µ —ç—Ç–æ?"');
                }
                
                saveUserData();
                showNotification(`‚úÖ "${getPowerupName(type)}" –∫—É–ø–ª–µ–Ω–æ!`);
            } else {
                showNotification('üí∏ –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ–Ω–µ–≥!');
            }
        }

        function getPowerupName(type) {
            return {
                extraLife: '–í—Ç–æ—Ä–∞—è –∂–∏–∑–Ω—å',
                slowMotion: '–ó–∞–º–µ–¥–ª–µ–Ω–∏–µ', 
                mystery: '–•–∑ —á–µ —ç—Ç–æ'
            }[type];
        }

        function selectPowerup(type) {
            if (userData.powerups[type] > 0) {
                selectedPowerup = type;
                document.querySelectorAll('.powerup-item').forEach(item => {
                    item.classList.remove('selected');
                });
                document.getElementById(`powerup${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('selected');
            } else {
                showNotification('‚ùå –£ –≤–∞—Å –Ω–µ—Ç —ç—Ç–æ–≥–æ —É—Å–∏–ª–µ–Ω–∏—è!');
            }
        }

        function startGameWithPowerups() {
            if (selectedPowerup && userData.powerups[selectedPowerup] > 0) {
                userData.powerups[selectedPowerup]--;
                saveUserData();
            }
            hidePowerups();
            startGame();
        }

        function initGame() {
            pigElement = document.getElementById('pig');
            gameArea = document.getElementById('gameArea');
            
            // –°–ë–†–ê–°–´–í–ê–ï–ú –§–õ–ê–ì –ì–†–ò–ë–ê –î–õ–Ø –ù–û–í–û–ô –ò–ì–†–´
            mushroomEatenThisGame = false;
            mushroomEaten = false;
            mushroomActivated = false;
            mushroomSpawned = false;
            foodSpeedMultiplier = 1;
            foodSpawned = 0;
            lightningActive = false;
            magnetActive = false;
            barrierActive = false;
            difficultyLevel = 1;
            baseFoodSpeed = 2;
            
            pigElement.textContent = 'üê∑';
            
            setupTouchControls();
            setupPauseControls();
            
            lives = selectedPowerup === 'extraLife' ? 2 : 1;
            coins = 0;
            timeLeft = config.gameTime;
            allFood = [];
            activeBoosters = {};
            
            updateUI();
        }

        function setupTouchControls() {
            pigElement.addEventListener('touchstart', (e) => {
                e.preventDefault();
                isDragging = true;
                pigElement.style.transition = 'none';
            });

            document.addEventListener('touchmove', (e) => {
                if (!isDragging || !gameActive || gamePaused) return;
                e.preventDefault();
                
                const touchX = e.touches[0].clientX;
                const pigRect = pigElement.getBoundingClientRect();
                const newX = touchX - pigRect.width / 2;
                const maxX = window.innerWidth - pigRect.width;
                
                pigElement.style.left = Math.max(0, Math.min(newX, maxX)) + 'px';
            });

            document.addEventListener('touchend', () => {
                isDragging = false;
                pigElement.style.transition = 'left 0.2s ease';
            });

            setInterval(() => {
                if (gameActive && !gamePaused) {
                    checkCollisions();
                }
            }, 50);
        }

        function setupPauseControls() {
            let lastTap = 0;
            gameArea.addEventListener('touchstart', (e) => {
                const currentTime = Date.now();
                if (currentTime - lastTap < 300) {
                    showPauseScreen();
                }
                lastTap = currentTime;
            });
        }

        function showPauseScreen() {
            if (!gameActive || gamePaused) return;
            gamePaused = true;
            clearInterval(spawnInterval);
            clearInterval(gameTimer);
            document.getElementById('pauseScreen').style.display = 'flex';
        }

        function resumeGame() {
            gamePaused = false;
            document.getElementById('pauseScreen').style.display = 'none';
            spawnInterval = setInterval(spawnFood, config.spawnInterval);
            gameTimer = setInterval(updateTimer, 1000);
        }

        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            
            gameActive = true;
            initGame();
            
            spawnInterval = setInterval(spawnFood, config.spawnInterval);
            gameTimer = setInterval(updateTimer, 1000);
        }

        function updateUI() {
            document.getElementById('livesCount').textContent = lives;
            document.getElementById('coinsCount').textContent = coins;
            document.getElementById('timer').textContent = timeLeft;
        }

        function updateTimer() {
            if (!gameActive || gamePaused) return;
            
            timeLeft--;
            
            if (timeLeft % 10 === 0) {
                difficultyLevel++;
                baseFoodSpeed += 0.3;
            }
            
            document.getElementById('timer').textContent = timeLeft;
            
            Object.keys(activeBoosters).forEach(booster => {
                activeBoosters[booster].timeLeft--;
                if (activeBoosters[booster].timeLeft <= 0) {
                    delete activeBoosters[booster];
                    hideBoosterTimer(booster);
                    
                    // –û—Ç–∫–ª—é—á–∞–µ–º –±–∞—Ä—å–µ—Ä, –∫–æ–≥–¥–∞ –≤—Ä–µ–º—è –≤—ã—à–ª–æ
                    if (booster === 'noHealthy') {
                        barrierActive = false;
                    }
                } else {
                    updateBoosterTimer(booster, activeBoosters[booster].timeLeft);
                }
            });
            
            if (timeLeft === 5 && mushroomActivated) {
                pigElement.textContent = 'üê∑';
            }
            
            if (timeLeft <= 0) {
                endGame(true);
            }
        }

        function showBoosterTimer(booster, duration) {
            const timerId = `boosterTimer${Object.keys(activeBoosters).length + 1}`;
            const timer = document.getElementById(timerId);
            if (timer) {
                timer.style.display = 'block';
                timer.innerHTML = `${config.boosterEmojis[booster]}: <span>${duration}</span>`;
                activeBoosters[booster] = {
                    timeLeft: duration,
                    timerId: timerId
                };
            }
        }

        function updateBoosterTimer(booster, timeLeft) {
            if (activeBoosters[booster]) {
                const timer = document.getElementById(activeBoosters[booster].timerId);
                if (timer) {
                    timer.querySelector('span').textContent = timeLeft;
                }
            }
        }

        function hideBoosterTimer(booster) {
            if (activeBoosters[booster]) {
                const timer = document.getElementById(activeBoosters[booster].timerId);
                if (timer) {
                    timer.style.display = 'none';
                }
            }
        }

        function spawnFood() {
            if (!gameActive || gamePaused) return;
            
            // –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω –±–∞—Ä—å–µ—Ä, –Ω–µ —Å–ø–∞–≤–Ω–∏–º –æ–≤–æ—â–∏
            if (barrierActive && Math.random() < 0.8) {
                return;
            }
            
            foodSpawned++;
            
            const food = document.createElement('div');
            food.className = 'food';
            
            let emoji, value = 10, isHealthy = false, isBooster = false, isSpecial = false;
            const random = Math.random();
            
            if (!mushroomSpawned && foodSpawned <= 3 && Math.random() < 0.7) {
                emoji = config.mushroomEmoji;
                isSpecial = true;
                mushroomSpawned = true;
                food.classList.add('mushroom');
            } else {
                let healthyRatio;
                if (lightningActive) {
                    healthyRatio = 0.95 + (Math.random() * 0.02);
                } else {
                    healthyRatio = 0.75 + (Math.random() * 0.15);
                }
                
                if (random < healthyRatio) {
                    emoji = config.healthyFoodEmojis[Math.floor(Math.random() * config.healthyFoodEmojis.length)];
                    isHealthy = true;
                    // –ò–∑–º–µ–Ω–µ–Ω–æ: –ø—Ä–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≥—Ä–∏–±–µ –æ–≤–æ—â–∏ –¥–∞—é—Ç +10, —Ñ–∞—Å—Ç—Ñ—É–¥ –æ—Ç–Ω–∏–º–∞–µ—Ç –∂–∏–∑–Ω—å
                    value = mushroomActivated ? 10 : -1;
                    food.classList.add('healthy-food');
                } else if (random < healthyRatio + 0.04) {
                    const boosters = Object.keys(config.boosterEmojis);
                    const booster = boosters[Math.floor(Math.random() * boosters.length)];
                    emoji = config.boosterEmojis[booster];
                    isBooster = true;
                    if (emoji === 'üß≤') {
                        food.classList.add('magnet');
                    } else if (emoji === 'üõ°Ô∏è') {
                        food.classList.add('barrier');
                    } else {
                        food.classList.add('booster-item');
                    }
                } else if (random < healthyRatio + 0.06) {
                    emoji = config.honeyEmoji;
                    isSpecial = true;
                    food.classList.add('honey');
                } else {
                    emoji = config.fastFoodEmojis[Math.floor(Math.random() * config.fastFoodEmojis.length)];
                    // –ò–∑–º–µ–Ω–µ–Ω–æ: –ø—Ä–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≥—Ä–∏–±–µ —Ñ–∞—Å—Ç—Ñ—É–¥ –æ—Ç–Ω–∏–º–∞–µ—Ç –∂–∏–∑–Ω—å
                    value = mushroomActivated ? -1 : 10;
                    food.classList.add('fast-food');
                }
            }
            
            food.textContent = emoji;
            food.dataset.value = value;
            food.dataset.type = isHealthy ? 'healthy' : (isBooster ? 'booster' : (isSpecial ? 'special' : 'fast'));
            food.dataset.emoji = emoji;
            
            const startX = Math.random() * (window.innerWidth - 60);
            food.style.left = startX + 'px';
            food.style.top = '-60px';
            
            gameArea.appendChild(food);
            
            const finalSpeed = (baseFoodSpeed + Math.random() * 2) * foodSpeedMultiplier;
            const foodObj = { 
                element: food, 
                speed: finalSpeed,
                attracted: false,
                startY: -60
            };
            allFood.push(foodObj);
            
            animateFood(foodObj);
        }

        function animateFood(foodObj) {
            if (!gameActive || gamePaused) return;
            
            const food = foodObj.element;
            const currentTop = parseInt(food.style.top);
            
            if (magnetActive && food.dataset.type === 'fast' && !foodObj.attracted && 
                currentTop > window.innerHeight / 3) {
                foodObj.attracted = true;
            }
            
            let newTop;
            if (foodObj.attracted) {
                const pigRect = pigElement.getBoundingClientRect();
                const foodRect = food.getBoundingClientRect();
                const targetX = pigRect.left + pigRect.width / 2 - foodRect.width / 2;
                const targetY = pigRect.top - foodRect.height;
                
                const currentX = parseInt(food.style.left);
                const dx = targetX - currentX;
                const dy = targetY - currentTop;
                
                const distance = Math.sqrt(dx * dx + dy * dy);
                const speed = 8;
                
                if (distance > 5) {
                    food.style.left = (currentX + (dx / distance) * speed) + 'px';
                    newTop = currentTop + (dy / distance) * speed;
                } else {
                    newTop = targetY;
                }
            } else {
                newTop = currentTop + foodObj.speed;
            }
            
            food.style.top = newTop + 'px';
            
            if (newTop > window.innerHeight) {
                food.remove();
                allFood = allFood.filter(f => f !== foodObj);
            } else {
                requestAnimationFrame(() => animateFood(foodObj));
            }
        }

        function checkCollisions() {
            if (!gameActive || gamePaused) return;
            
            const pigRect = pigElement.getBoundingClientRect();
            
            allFood.forEach((foodObj, index) => {
                const food = foodObj.element;
                const foodRect = food.getBoundingClientRect();
                
                if (pigRect.left < foodRect.right &&
                    pigRect.right > foodRect.left &&
                    pigRect.top < foodRect.bottom &&
                    pigRect.bottom > foodRect.top) {
                    
                    handleFoodCollection(food);
                    allFood.splice(index, 1);
                }
            });
        }

        function handleFoodCollection(food) {
            const value = parseInt(food.dataset.value);
            const type = food.dataset.type;
            const emoji = food.dataset.emoji;
            const rect = food.getBoundingClientRect();
            
            if (emoji === config.mushroomEmoji) {
                mushroomEaten = true;
                mushroomEatenThisGame = true; // –£–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú –§–õ–ê–ì
                mushroomActivated = true;
                pigElement.textContent = 'ü´Ñ';
                showNotification('üçÑ –ì—Ä–∏–± —Å—ä–µ–¥–µ–Ω! –ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ!');
                
                // –£–ë–†–ê–ù–ê –í–´–î–ê–ß–ê –î–û–°–¢–ò–ñ–ï–ù–ò–Ø –ó–î–ï–°–¨ - –æ–Ω–æ –±—É–¥–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã
                
            } else if (type === 'healthy') {
                if (mushroomActivated) {
                    coins += value;
                    showCoinText(value, rect.left + rect.width/2, rect.top + rect.height/2);
                } else {
                    lives--;
                    showNotification('üíî -1 –∂–∏–∑–Ω—å!');
                }
            } else if (type === 'fast') {
                if (mushroomActivated) {
                    lives--;
                    showNotification('üíî -1 –∂–∏–∑–Ω—å!');
                } else {
                    coins += value;
                    showCoinText(value, rect.left + rect.width/2, rect.top + rect.height/2);
                }
            } else if (type === 'booster') {
                handleBooster(emoji);
            } else if (type === 'special' && emoji === config.honeyEmoji) {
                showNotification('üçØ –ú–µ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!');
            }
            
            food.style.transform = 'scale(0)';
            food.style.opacity = '0';
            setTimeout(() => {
                if (food.parentNode) {
                    food.remove();
                }
            }, 200);
            
            updateUI();
            
            if (lives <= 0) {
                if (humanTransformationTimer) {
                    clearTimeout(humanTransformationTimer);
                }
                endGame(false);
            }
        }

        function handleBooster(emoji) {
            switch(emoji) {
                case 'ü™ô':
                    showBoosterTimer('coin', 10);
                    break;
                case 'üõ°Ô∏è': // –ë–∞—Ä—å–µ—Ä - —É–±–∏—Ä–∞–µ—Ç –≤—Å–µ –æ–≤–æ—â–∏ –Ω–∞ 15 —Å–µ–∫—É–Ω–¥
                    barrierActive = true;
                    showBoosterTimer('noHealthy', 15);
                    showNotification('üõ°Ô∏è –ë–∞—Ä—å–µ—Ä –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –û–≤–æ—â–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è 15 —Å–µ–∫—É–Ω–¥!');
                    
                    // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Ç–µ–∫—É—â–∏–µ –æ–≤–æ—â–∏
                    allFood.forEach((foodObj, index) => {
                        if (foodObj.element.dataset.type === 'healthy') {
                            foodObj.element.remove();
                            allFood.splice(index, 1);
                        }
                    });
                    
                    setTimeout(() => {
                        barrierActive = false;
                    }, 15000);
                    break;
                case '‚ö°':
                    lightningActive = true;
                    showBoosterTimer('lightning', 10);
                    setTimeout(() => {
                        lightningActive = false;
                    }, 10000);
                    break;
                case 'üß≤':
                    magnetActive = true;
                    showBoosterTimer('magnet', 8);
                    setTimeout(() => {
                        magnetActive = false;
                    }, 8000);
                    break;
            }
        }

        function endGame(isWin) {
            gameActive = false;
            clearInterval(spawnInterval);
            clearInterval(gameTimer);
            if (humanTransformationTimer) {
                clearTimeout(humanTransformationTimer);
            }
            
            // –ü–†–û–í–ï–†–Ø–ï–ú –î–û–°–¢–ò–ñ–ï–ù–ò–ï "–¢–ï–ü–ï–†–¨ –¢–´ –ù–û–†–ú–ê–õ–¨–ù–´–ô –ß–ï–õ–û–í–ï–ö" –¢–û–õ–¨–ö–û –ü–†–ò –£–°–ü–ï–®–ù–û–ú –ó–ê–í–ï–†–®–ï–ù–ò–ò
            if (isWin && mushroomEatenThisGame) {
                if (!userData.achievements.normalHuman.unlocked) {
                    userData.achievements.normalHuman.unlocked = true;
                    userData.achievements.normalHuman.count = 1;
                    showNotification('üéâ –ü–æ–ª—É—á–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: "–¢–ï–ü–ï–†–¨ –¢–´ –ù–û–†–ú–ê–õ–¨–ù–´–ô –ß–ï–õ–û–í–ï–ö"');
                    saveUserData();
                }
            }
            
            allFood.forEach(food => {
                if (food.element.parentNode) {
                    food.element.remove();
                }
            });
            allFood = [];
            
            userData.totalCoins += coins;
            saveUserData();
            
            document.getElementById('finalCoins').textContent = coins;
            document.getElementById('finalTime').textContent = config.gameTime - timeLeft;
            
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'flex';
        }

        function showFriends() {
            document.getElementById('friendsScreen').style.display = 'flex';
        }

        function hideFriends() {
            document.getElementById('friendsScreen').style.display = 'none';
        }

        function showProfileEdit() {
            generateAvatarGrid();
            document.getElementById('profileEditScreen').style.display = 'flex';
        }

        function hideProfileEdit() {
            document.getElementById('profileEditScreen').style.display = 'none';
        }

        function saveProfile() {
            const newName = document.getElementById('profileNameInput').value.trim();
            if (newName) {
                userData.profile.name = newName;
                saveUserData();
                updateProfileDisplay();
                hideProfileEdit();
                showNotification('‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
            }
        }

        function searchFriend() {
            const friendId = document.getElementById('friendSearch').value;
            if (friendId) {
                showNotification(`üîç –ü–æ–∏—Å–∫ –¥—Ä—É–≥–∞ —Å ID: ${friendId}`);
            }
        }

        function showWallpaper() {
            generateColorPalette();
            selectedColor = null;
            selectedImage = null;
            document.querySelectorAll('.color-item').forEach(item => {
                item.classList.remove('selected');
            });
            document.getElementById('wallpaperScreen').style.display = 'flex';
        }

        function hideWallpaper() {
            document.getElementById('wallpaperScreen').style.display = 'none';
        }

        function showShop() {
            document.getElementById('shopScreen').style.display = 'flex';
        }

        function hideShop() {
            document.getElementById('shopScreen').style.display = 'none';
        }

        function showPowerups() {
            document.getElementById('powerupsScreen').style.display = 'flex';
        }

        function hidePowerups() {
            document.getElementById('powerupsScreen').style.display = 'none';
        }

        function showHelp() {
            document.getElementById('helpScreen').style.display = 'flex';
        }

        function hideHelp() {
            document.getElementById('helpScreen').style.display = 'none';
        }

        function showAchievements() {
            loadUserData();
            document.getElementById('achievementsScreen').style.display = 'flex';
        }

        function hideAchievements() {
            document.getElementById('achievementsScreen').style.display = 'none';
        }

        function showAchievementsFromPause() {
            document.getElementById('pauseScreen').style.display = 'none';
            showAchievements();
        }

        function exitToMenuFromPause() {
            document.getElementById('pauseScreen').style.display = 'none';
            exitToMenu();
        }

        function exitToMenu() {
            document.getElementById('resultScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'flex';
            gameActive = false;
            gamePaused = false;
            if (humanTransformationTimer) {
                clearTimeout(humanTransformationTimer);
            }
        }

        window.addEventListener('load', loadUserData);
    </script>
</body>
</html>
